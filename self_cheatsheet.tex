% Copyright (c) 2016 Bystroushaak

% Permission is hereby granted, free of charge, to any person
% obtaining a copy of this software and associated documentation
% files (the "Software"), to deal in the Software without
% restriction, including without limitation the rights to use,
% copy, modify, merge, publish, distribute, sublicense, and/or sell
% copies of the Software, and to permit persons to whom the
% Software is furnished to do so, subject to the following
% conditions:

% The above copyright notice and this permission notice shall be
% included in all copies or substantial portions of the Software.

% THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
% EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
% OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
% NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
% HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
% WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
% FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
% OTHER DEALINGS IN THE SOFTWARE.

% Inspired by http://tex.stackexchange.com/questions/99765/document-class-for-reference-cards
\documentclass[10pt]{article}
\usepackage{fixltx2e}
\usepackage[orthodox,l2tabu,abort]{nag}
\usepackage{textcomp}
\usepackage{hyperref}

% Page layout
\usepackage[landscape,margin=0.5in]{geometry}
\usepackage{multicol}

% Title area
\usepackage{titling} % Allows for use of date, author, etc. after \maketitle
% Ref: http://tex.stackexchange.com/questions/3988/titlesec-versus-titling-mangling-thetitle
\let\oldtitle\title
\renewcommand{\title}[1]{\oldtitle{#1}\newcommand{\mythetitle}{#1}}
\renewcommand{\maketitle}{
    {\begin{center}\Large \mythetitle\end{center}}
}

% Document divisions
\usepackage{titlesec}
\setcounter{secnumdepth}{0}
\titlespacing{\section}{0pt}{0pt}{0pt}
\titlespacing{\subsection}{0pt}{5pt}{0pt}
\usepackage{nopageno} % To keep \section from resetting page style

\setlength{\parindent}{0pt} % disabling indentation by default

% Lists
\usepackage{enumitem} % for consistent formatting of lists
\newlist{ttdesc}{description}{1}
\setlist[ttdesc]{font=\ttfamily,noitemsep}
\usepackage{calc} % for \widthof

% Code
\usepackage{listings}
\lstset{language=[LaTeX]TeX,
    basicstyle=\itshape,
    keywordstyle=\normalfont\ttfamily,
    morekeywords={part,chapter,subsection,subsubsection,paragraph,subparagraph}
}

\usepackage{lipsum}

% Metadata definition
\title{Selflang cheat sheet}
\author{Bystroushaak}
\date{2016}

\pdfinfo {
    /Author   (\theauthor)
    /Title    (\thetitle)
    /Subject  (\thetitle)
    /Keywords (Self, SelfLang, programming language, programming)
}


% Content definition
\begin{document}
\begin{multicols*}{3}
\maketitle

\section{Object syntax}
An \textit{object} consists from (possibly empty) set of \textit{slots} and (optionally) \textit{code}.

\vspace*{0.2cm}
\texttt{(| slot1. slot2 | 'code')}

for object with code, or

\texttt{(| | 'code')} or \texttt{('code')}

for object with code, but no slots, or

\texttt{(| slot1. slot2. slotN |)}

for object with slots, but no code, or

\texttt{()}

for empty object.
\vspace*{0.2cm}

Slots behave as key-value lookup table. \textit{Code} is a sequenece of \textit{expressions} (\textit{message sends} and \textit{literals}) separated by dots, and evaluated in order.

\subsection{Block objects}
\textit{Block objects} share syntax with \textit{objects}, except that square brackts are used instead of round:

\vspace*{0.2cm}
\texttt{[| slot1. slot2 | 'code']}
\vspace*{0.2cm}

\textit{Block objects} works as closures and supports return statement using \texttt{\^} preceding the returned value. If not used, result of last \textit{expression} is returned.

% \textit{code} defined in the blocks may be evaluated by sending \texttt{value:} message. % TODO: ověřit

\subsection{Slot assignments}
Slots can be assigned at the definition, either read only using \texttt{=} operator:

\begin{verbatim}
(| slot1 = 1 |)
\end{verbatim}

or rewritable using \texttt{<-} operator: % TODO: operator, really?
\begin{verbatim}
(| slot1 <- 1 |)
\end{verbatim}

\subsection{Message sends}





\section{Control sequences}
\subsection{If condition}

As usual in Smalltalk-like languages, \textit{if condition} is implemented as everything else by sending messages, in this case to boolean-like objects:

\vspace*{0.2cm}
\begin{tabular}{ p{70pt} p{140pt} l l }
Command & Description \\ \hline
\begin{verbatim}obj ifTrue: b1
    False: b2
\end{verbatim}
&\vspace*{0.1cm} \textit{b1} is executed, when \textit{obj} evaluates to \texttt{true}.
If not, (optional) \textit{b2} block is used. \\
\hline


\end{tabular}





% Footer
\vfill \hrule\smallskip
{\small This card may be freely distributed under
the terms of the MIT licence ---
Copyleft \textcopyleft\ \thedate{} by \href{http://kitakitsune.org}{\theauthor}.

\url{https://github.com/Bystroushaak/SelfCheatSheet}
}

\end{multicols*}
\end{document}
